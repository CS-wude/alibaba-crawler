# èƒ¸éƒ¨Xå…‰ç‰‡AIåˆ†æç³»ç»Ÿ - å®Œæ•´éƒ¨ç½²æ–‡æ¡£

> ç‰ˆæœ¬: v1.0  
> æ›´æ–°æ—¥æœŸ: 2025å¹´1æœˆ  
> ä½œè€…: AI Medical Imaging Team

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
3. [å¼€å‘ç¯å¢ƒéƒ¨ç½²](#å¼€å‘ç¯å¢ƒéƒ¨ç½²)
4. [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
5. [Ollamaé…ç½®](#ollamaé…ç½®)
6. [åŠŸèƒ½éªŒè¯](#åŠŸèƒ½éªŒè¯)
7. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
8. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
9. [ç›‘æ§ä¸ç»´æŠ¤](#ç›‘æ§ä¸ç»´æŠ¤)
10. [å®‰å…¨é…ç½®](#å®‰å…¨é…ç½®)
11. [å¤‡ä»½ä¸æ¢å¤](#å¤‡ä»½ä¸æ¢å¤)
12. [FAQ](#faq)

---

## ğŸ¥ ç³»ç»Ÿæ¦‚è¿°

### åŠŸèƒ½ç‰¹æ€§
- **AIå›¾åƒåˆ†æ**: åŸºäºResNet50çš„èƒ¸éƒ¨Xå…‰ç‰‡åˆ†ç±»
- **åŒæ¨¡å¼æŠ¥å‘Š**: Ollamaæ™ºèƒ½æŠ¥å‘Š + å¢å¼ºç‰ˆä¸“ä¸šæŠ¥å‘Š
- **Webç•Œé¢**: ç°ä»£åŒ–å“åº”å¼è®¾è®¡
- **ç”¨æˆ·é€‰æ‹©**: å¯åˆ‡æ¢æŠ¥å‘Šç”Ÿæˆæ–¹å¼
- **å¤šæ ¼å¼æ”¯æŒ**: PNG, JPG, JPEG, GIF, BMP, TIFF
- **æŠ¥å‘Šä¿å­˜**: è‡ªåŠ¨ä¿å­˜åˆ†æç»“æœä¸ºJSON

### æŠ€æœ¯æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Webç•Œé¢ (Flask)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          AIåˆ†æå¼•æ“                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ResNet50      â”‚ â”‚     Ollama      â”‚ â”‚
â”‚  â”‚   å›¾åƒåˆ†ç±»       â”‚ â”‚     LLMæŠ¥å‘Š     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            PyTorch Backend              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

| ç»„ä»¶ | æœ€ä½é…ç½® | æ¨èé…ç½® | ç”Ÿäº§ç¯å¢ƒ |
|------|----------|----------|----------|
| **CPU** | 2æ ¸å¿ƒ | 4æ ¸å¿ƒ+ | 8æ ¸å¿ƒ+ |
| **å†…å­˜** | 4GB | 8GB+ | 16GB+ |
| **å­˜å‚¨** | 10GB | 50GB+ | 100GB+ |
| **GPU** | å¯é€‰ | GTX 1060+ | RTX 3080+ |
| **å¸¦å®½** | 10Mbps | 100Mbps+ | 1Gbps+ |

### è½¯ä»¶è¦æ±‚

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| **æ“ä½œç³»ç»Ÿ** | Windows 10+, Ubuntu 18.04+, macOS 10.15+ | è·¨å¹³å°æ”¯æŒ |
| **Python** | 3.7+ | æ¨è3.8-3.10 |
| **pip** | æœ€æ–°ç‰ˆ | åŒ…ç®¡ç†å™¨ |
| **Git** | 2.0+ | ç‰ˆæœ¬æ§åˆ¶ |
| **Ollama** | æœ€æ–°ç‰ˆ | å¯é€‰LLMæœåŠ¡ |

---

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒéƒ¨ç½²

### æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡

#### 1.1 åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv pytorch_cpu_env

# æ¿€æ´»ç¯å¢ƒ
# Windows:
pytorch_cpu_env\Scripts\activate

# Linux/macOS:
source pytorch_cpu_env/bin/activate
```

#### 1.2 å‡çº§pip
```bash
python -m pip install --upgrade pip
```

### æ­¥éª¤2: è·å–é¡¹ç›®ä»£ç 

```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœæ˜¯Gitä»“åº“ï¼‰
git clone <repository-url>
cd ChestXRay/learn

# æˆ–ç›´æ¥ä½¿ç”¨ç°æœ‰ä»£ç 
cd /path/to/ChestXRay/learn
```

### æ­¥éª¤3: å®‰è£…ä¾èµ–

#### 3.1 å®‰è£…åŸºç¡€ä¾èµ–
```bash
# å®‰è£…PyTorch (CPUç‰ˆæœ¬)
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu

# å®‰è£…Webåº”ç”¨ä¾èµ–
pip install -r web_requirements.txt

# å®‰è£…å®Œæ•´é¡¹ç›®ä¾èµ–
pip install -r requirements.txt
```

#### 3.2 éªŒè¯PyTorchå®‰è£…
```bash
python -c "
import torch
import torchvision
print(f'PyTorchç‰ˆæœ¬: {torch.__version__}')
print(f'TorchVisionç‰ˆæœ¬: {torchvision.__version__}')
print(f'CUDAå¯ç”¨: {torch.cuda.is_available()}')
"
```

### æ­¥éª¤4: æ¨¡å‹å‡†å¤‡

#### 4.1 æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
```bash
# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la checkpoints/best_model.pth

# å¦‚æœä¸å­˜åœ¨ï¼Œéœ€è¦è®­ç»ƒæ¨¡å‹
python main.py train
```

#### 4.2 éªŒè¯æ¨¡å‹åŠ è½½
```bash
# æµ‹è¯•æ¨¡å‹ä¿¡æ¯
python main.py info --model_name resnet50
```

### æ­¥éª¤5: ç›®å½•ç»“æ„æ£€æŸ¥

ç¡®ä¿ä»¥ä¸‹ç›®å½•ç»“æ„å­˜åœ¨ï¼š
```
ChestXRay/learn/
â”œâ”€â”€ checkpoints/
â”‚   â””â”€â”€ best_model.pth          # è®­ç»ƒå¥½çš„æ¨¡å‹
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ reports/                # æŠ¥å‘Šä¿å­˜ç›®å½•
â”œâ”€â”€ templates/                  # HTMLæ¨¡æ¿
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åº
â”œâ”€â”€ web_app.py                 # Webåº”ç”¨
â”œâ”€â”€ run_web.py                 # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt           # ä¾èµ–æ–‡ä»¶
â””â”€â”€ web_requirements.txt       # Webä¾èµ–
```

### æ­¥éª¤6: å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
python run_web.py

# æ–¹æ³•2: ç›´æ¥å¯åŠ¨Flask
python web_app.py

# æ–¹æ³•3: æŒ‡å®šå‚æ•°å¯åŠ¨
python run_web.py --host 0.0.0.0 --port 8080
```

### æ­¥éª¤7: éªŒè¯éƒ¨ç½²

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:5000
2. ä¸Šä¼ æµ‹è¯•Xå…‰ç‰‡å›¾åƒ
3. æ£€æŸ¥åˆ†æç»“æœå’ŒæŠ¥å‘Šç”Ÿæˆ

---

## ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### æ­¥éª¤1: æœåŠ¡å™¨å‡†å¤‡

#### 1.1 ç³»ç»Ÿæ›´æ–°
```bash
# Ubuntu/Debian
sudo apt update && sudo apt upgrade -y

# CentOS/RHEL
sudo yum update -y
```

#### 1.2 å®‰è£…ç³»ç»Ÿä¾èµ–
```bash
# Ubuntu/Debian
sudo apt install -y python3 python3-pip python3-venv git nginx supervisor

# CentOS/RHEL
sudo yum install -y python3 python3-pip git nginx supervisor
```

### æ­¥éª¤2: åº”ç”¨éƒ¨ç½²

#### 2.1 åˆ›å»ºåº”ç”¨ç›®å½•
```bash
sudo mkdir -p /opt/chestxray-ai
sudo chown $USER:$USER /opt/chestxray-ai
cd /opt/chestxray-ai
```

#### 2.2 éƒ¨ç½²åº”ç”¨ä»£ç 
```bash
# å¤åˆ¶ä»£ç 
cp -r /path/to/ChestXRay/learn/* /opt/chestxray-ai/

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install --upgrade pip
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
pip install -r requirements.txt
pip install -r web_requirements.txt

# å®‰è£…ç”Ÿäº§ç¯å¢ƒWSGIæœåŠ¡å™¨
pip install gunicorn
```

### æ­¥éª¤3: åˆ›å»ºç”Ÿäº§å¯åŠ¨è„šæœ¬

#### 3.1 åˆ›å»ºGunicorné…ç½®
```bash
cat > /opt/chestxray-ai/gunicorn.conf.py << 'EOF'
# Gunicorné…ç½®æ–‡ä»¶
bind = "127.0.0.1:5000"
workers = 4
worker_class = "sync"
worker_connections = 1000
max_requests = 1000
max_requests_jitter = 50
timeout = 300
keepalive = 2
preload_app = True
chdir = "/opt/chestxray-ai"
user = "www-data"
group = "www-data"

# æ—¥å¿—é…ç½®
accesslog = "/var/log/chestxray-ai/access.log"
errorlog = "/var/log/chestxray-ai/error.log"
loglevel = "info"

# è¿›ç¨‹å‘½å
proc_name = "chestxray-ai"
EOF
```

#### 3.2 åˆ›å»ºå¯åŠ¨è„šæœ¬
```bash
cat > /opt/chestxray-ai/start.sh << 'EOF'
#!/bin/bash
cd /opt/chestxray-ai
source venv/bin/activate
exec gunicorn -c gunicorn.conf.py web_app:app
EOF

chmod +x /opt/chestxray-ai/start.sh
```

### æ­¥éª¤4: é…ç½®ç³»ç»ŸæœåŠ¡

#### 4.1 åˆ›å»ºSystemdæœåŠ¡
```bash
sudo cat > /etc/systemd/system/chestxray-ai.service << 'EOF'
[Unit]
Description=ChestXRay AI Analysis System
After=network.target

[Service]
Type=exec
User=www-data
Group=www-data
WorkingDirectory=/opt/chestxray-ai
Environment=PATH=/opt/chestxray-ai/venv/bin
ExecStart=/opt/chestxray-ai/start.sh
ExecReload=/bin/kill -s HUP $MAINPID
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF
```

#### 4.2 å¯åŠ¨æœåŠ¡
```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
sudo mkdir -p /var/log/chestxray-ai
sudo chown www-data:www-data /var/log/chestxray-ai

# è®¾ç½®æƒé™
sudo chown -R www-data:www-data /opt/chestxray-ai

# å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable chestxray-ai
sudo systemctl start chestxray-ai

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status chestxray-ai
```

### æ­¥éª¤5: é…ç½®Nginxåå‘ä»£ç†

#### 5.1 åˆ›å»ºNginxé…ç½®
```bash
sudo cat > /etc/nginx/sites-available/chestxray-ai << 'EOF'
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºå®é™…åŸŸå
    
    # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
    client_max_body_size 20M;
    
    # é™æ€æ–‡ä»¶
    location /static {
        alias /opt/chestxray-ai/static;
        expires 1d;
        add_header Cache-Control "public, immutable";
    }
    
    # ä¸»åº”ç”¨
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
    }
    
    # å¥åº·æ£€æŸ¥
    location /health {
        proxy_pass http://127.0.0.1:5000/health;
        access_log off;
    }
}
EOF
```

#### 5.2 å¯ç”¨ç«™ç‚¹
```bash
# å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/chestxray-ai /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

### æ­¥éª¤6: HTTPSé…ç½® (æ¨è)

#### 6.1 å®‰è£…Certbot
```bash
sudo apt install certbot python3-certbot-nginx
```

#### 6.2 è·å–SSLè¯ä¹¦
```bash
sudo certbot --nginx -d your-domain.com
```

---

## ğŸ¦™ Ollamaé…ç½®

### æ­¥éª¤1: å®‰è£…Ollama

#### 1.1 Linux/macOSå®‰è£…
```bash
curl -fsSL https://ollama.ai/install.sh | sh
```

#### 1.2 Windowså®‰è£…
ä» https://ollama.ai/download/windows ä¸‹è½½å®‰è£…åŒ…

#### 1.3 éªŒè¯å®‰è£…
```bash
ollama --version
```

### æ­¥éª¤2: é…ç½®OllamaæœåŠ¡

#### 2.1 å¯åŠ¨OllamaæœåŠ¡
```bash
# å‰å°è¿è¡Œï¼ˆæµ‹è¯•ï¼‰
ollama serve

# åå°æœåŠ¡
systemctl start ollama  # Linux
```

#### 2.2 ä¸‹è½½åŒ»å­¦æ¨¡å‹
```bash
# æ¨èæ¨¡å‹ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
ollama pull llama3.1:8b     # é«˜è´¨é‡é€šç”¨æ¨¡å‹
ollama pull llama2:7b       # ç¨³å®šä¸­å‹æ¨¡å‹
ollama pull gemma:7b        # Googleæ¨¡å‹

# æŸ¥çœ‹å·²å®‰è£…æ¨¡å‹
ollama list
```

### æ­¥éª¤3: ç”Ÿäº§ç¯å¢ƒOllamaé…ç½®

#### 3.1 åˆ›å»ºOllamaç”¨æˆ·
```bash
sudo useradd -r -s /bin/false ollama
```

#### 3.2 é…ç½®SystemdæœåŠ¡
```bash
sudo cat > /etc/systemd/system/ollama.service << 'EOF'
[Unit]
Description=Ollama Service
After=network.target

[Service]
Type=exec
User=ollama
Group=ollama
ExecStart=/usr/local/bin/ollama serve
Environment=OLLAMA_HOST=127.0.0.1:11434
Environment=OLLAMA_MODELS=/opt/ollama/models
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
EOF

# åˆ›å»ºæ¨¡å‹ç›®å½•
sudo mkdir -p /opt/ollama/models
sudo chown ollama:ollama /opt/ollama/models

# å¯åŠ¨æœåŠ¡
sudo systemctl enable ollama
sudo systemctl start ollama
```

### æ­¥éª¤4: æµ‹è¯•Ollamaé›†æˆ

```bash
cd /opt/chestxray-ai
source venv/bin/activate

# æµ‹è¯•Ollamaè¿æ¥
python test_ollama.py

# æµ‹è¯•å¤šæ¨¡æ€AI
python test_multimodal.py
```

---

## âœ… åŠŸèƒ½éªŒè¯

### 1. ç³»ç»Ÿå¥åº·æ£€æŸ¥

```bash
# Webåº”ç”¨å¥åº·æ£€æŸ¥
curl http://localhost/health

# é¢„æœŸå“åº”
{
  "status": "healthy",
  "ai_systems": {
    "initialization_status": "success",
    "multimodal_available": true,
    "basic_predictor_available": true
  }
}
```

### 2. APIæµ‹è¯•

```bash
# æµ‹è¯•æ–‡ä»¶ä¸Šä¼ 
curl -X POST -F "file=@test_image.jpg" -F "use_ollama=true" \
     http://localhost/upload
```

### 3. ç”¨æˆ·ç•Œé¢æµ‹è¯•

1. **è®¿é—®ä¸»é¡µ**: http://your-domain.com
2. **ä¸Šä¼ æµ‹è¯•**: é€‰æ‹©æµ‹è¯•Xå…‰ç‰‡
3. **åˆ‡æ¢æ¨¡å¼**: æµ‹è¯•Ollama/å¢å¼ºç‰ˆæŠ¥å‘Šåˆ‡æ¢
4. **ç»“æœéªŒè¯**: ç¡®è®¤æŠ¥å‘Šæ­£å¸¸ç”Ÿæˆ

### 4. æ€§èƒ½æµ‹è¯•

```bash
# ä½¿ç”¨Apache Benchæµ‹è¯•
ab -n 100 -c 10 http://localhost/

# ä½¿ç”¨wrkæµ‹è¯•
wrk -t12 -c400 -d30s http://localhost/
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. AIç³»ç»Ÿæœªåˆå§‹åŒ–
```bash
# ç—‡çŠ¶ï¼šAIç³»ç»Ÿæœªåˆå§‹åŒ–
# æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
ls -la checkpoints/best_model.pth

# é‡æ–°è®­ç»ƒæ¨¡å‹
python main.py train

# æ£€æŸ¥æ—¥å¿—
tail -f /var/log/chestxray-ai/error.log
```

#### 2. Ollamaè¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥OllamaæœåŠ¡
systemctl status ollama

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 11434

# æµ‹è¯•è¿æ¥
curl http://localhost:11434/api/version
```

#### 3. æ–‡ä»¶ä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥æƒé™
sudo chown -R www-data:www-data /opt/chestxray-ai/static

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# æ£€æŸ¥Nginxé…ç½®
nginx -t
```

#### 4. å†…å­˜ä¸è¶³
```bash
# ç›‘æ§å†…å­˜ä½¿ç”¨
htop
free -m

# è°ƒæ•´Gunicorn workers
# ç¼–è¾‘ gunicorn.conf.py
workers = 2  # å‡å°‘workeræ•°é‡
```

### æ—¥å¿—ä½ç½®

| ç»„ä»¶ | æ—¥å¿—ä½ç½® | è¯´æ˜ |
|------|----------|------|
| **åº”ç”¨** | `/var/log/chestxray-ai/error.log` | åº”ç”¨é”™è¯¯æ—¥å¿— |
| **è®¿é—®** | `/var/log/chestxray-ai/access.log` | è®¿é—®æ—¥å¿— |
| **Nginx** | `/var/log/nginx/error.log` | Nginxé”™è¯¯ |
| **ç³»ç»Ÿ** | `/var/log/syslog` | ç³»ç»Ÿæ—¥å¿— |

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### 1. åº”ç”¨å±‚ä¼˜åŒ–

#### 1.1 æ¨¡å‹é¢„åŠ è½½
```python
# åœ¨web_app.pyä¸­æ·»åŠ 
from werkzeug.middleware.profiler import ProfilerMiddleware
app.wsgi_app = ProfilerMiddleware(app.wsgi_app)
```

#### 1.2 ç¼“å­˜é…ç½®
```python
from flask_caching import Cache

# é…ç½®ç¼“å­˜
app.config['CACHE_TYPE'] = 'redis'
app.config['CACHE_REDIS_URL'] = 'redis://localhost:6379'
cache = Cache(app)
```

### 2. ç³»ç»Ÿå±‚ä¼˜åŒ–

#### 2.1 è°ƒæ•´æ–‡ä»¶å¥æŸ„é™åˆ¶
```bash
# ç¼–è¾‘ /etc/security/limits.conf
* soft nofile 65535
* hard nofile 65535
```

#### 2.2 å†…æ ¸å‚æ•°ä¼˜åŒ–
```bash
# ç¼–è¾‘ /etc/sysctl.conf
net.core.somaxconn = 1024
net.ipv4.tcp_max_syn_backlog = 2048
```

### 3. æ•°æ®åº“ä¼˜åŒ–ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

```bash
# Redisä¼˜åŒ–
echo 'vm.overcommit_memory = 1' >> /etc/sysctl.conf
sysctl vm.overcommit_memory=1
```

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### 1. ç³»ç»Ÿç›‘æ§

#### 1.1 å®‰è£…Prometheus + Grafana
```bash
# å®‰è£…Prometheus
wget https://github.com/prometheus/prometheus/releases/download/v2.37.0/prometheus-2.37.0.linux-amd64.tar.gz
tar xvfz prometheus-*.tar.gz
sudo mv prometheus-2.37.0.linux-amd64 /opt/prometheus

# é…ç½®ç›‘æ§
cat > /opt/prometheus/prometheus.yml << 'EOF'
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'chestxray-ai'
    static_configs:
      - targets: ['localhost:5000']
    metrics_path: '/metrics'
    scrape_interval: 5s
EOF
```

#### 1.2 ç›‘æ§æŒ‡æ ‡
- **CPUä½¿ç”¨ç‡**
- **å†…å­˜ä½¿ç”¨ç‡**
- **ç£ç›˜I/O**
- **ç½‘ç»œæµé‡**
- **å“åº”æ—¶é—´**
- **é”™è¯¯ç‡**

### 2. æ—¥å¿—ç®¡ç†

#### 2.1 æ—¥å¿—è½®è½¬
```bash
# åˆ›å»ºlogrotateé…ç½®
sudo cat > /etc/logrotate.d/chestxray-ai << 'EOF'
/var/log/chestxray-ai/*.log {
    daily
    missingok
    rotate 52
    compress
    notifempty
    create 0644 www-data www-data
    postrotate
        systemctl reload chestxray-ai
    endscript
}
EOF
```

#### 2.2 é›†ä¸­æ—¥å¿—æ”¶é›†
```bash
# ä½¿ç”¨ELK Stackæˆ–Fluentd
# é…ç½®æ—¥å¿—è½¬å‘åˆ°ä¸­å¤®æ—¥å¿—æœåŠ¡å™¨
```

### 3. è‡ªåŠ¨åŒ–è¿ç»´

#### 3.1 å¥åº·æ£€æŸ¥è„šæœ¬
```bash
cat > /opt/scripts/health_check.sh << 'EOF'
#!/bin/bash
# å¥åº·æ£€æŸ¥è„šæœ¬

URL="http://localhost/health"
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" $URL)

if [ $RESPONSE -eq 200 ]; then
    echo "$(date): Service is healthy"
else
    echo "$(date): Service is unhealthy, response: $RESPONSE"
    systemctl restart chestxray-ai
fi
EOF

chmod +x /opt/scripts/health_check.sh

# æ·»åŠ åˆ°crontab
echo "*/5 * * * * /opt/scripts/health_check.sh >> /var/log/health_check.log" | crontab -
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### 1. é˜²ç«å¢™é…ç½®

```bash
# UFWé…ç½®
sudo ufw allow 22/tcp      # SSH
sudo ufw allow 80/tcp      # HTTP
sudo ufw allow 443/tcp     # HTTPS
sudo ufw deny 5000/tcp     # æ‹’ç»ç›´æ¥è®¿é—®åº”ç”¨ç«¯å£
sudo ufw deny 11434/tcp    # æ‹’ç»ç›´æ¥è®¿é—®Ollamaç«¯å£
sudo ufw enable
```

### 2. SSL/TLSå¼ºåŒ–

```bash
# Nginx SSLé…ç½®å¢å¼º
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
ssl_prefer_server_ciphers off;
add_header Strict-Transport-Security "max-age=63072000" always;
```

### 3. åº”ç”¨å®‰å…¨

```python
# åœ¨web_app.pyä¸­æ·»åŠ å®‰å…¨å¤´
from flask_talisman import Talisman

Talisman(app, {
    'force_https': True,
    'content_security_policy': {
        'default-src': "'self'",
        'script-src': "'self' 'unsafe-inline'",
        'style-src': "'self' 'unsafe-inline'"
    }
})
```

---

## ğŸ’¾ å¤‡ä»½ä¸æ¢å¤

### 1. æ•°æ®å¤‡ä»½

#### 1.1 æ¨¡å‹æ–‡ä»¶å¤‡ä»½
```bash
#!/bin/bash
# å¤‡ä»½è„šæœ¬
BACKUP_DIR="/backup/chestxray-ai"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR/$DATE

# å¤‡ä»½æ¨¡å‹æ–‡ä»¶
cp /opt/chestxray-ai/checkpoints/best_model.pth $BACKUP_DIR/$DATE/

# å¤‡ä»½é…ç½®æ–‡ä»¶
cp -r /opt/chestxray-ai/*.py $BACKUP_DIR/$DATE/
cp -r /opt/chestxray-ai/templates $BACKUP_DIR/$DATE/

# å‹ç¼©å¤‡ä»½
tar -czf $BACKUP_DIR/backup_$DATE.tar.gz -C $BACKUP_DIR $DATE/
rm -rf $BACKUP_DIR/$DATE

echo "Backup completed: $BACKUP_DIR/backup_$DATE.tar.gz"
```

#### 1.2 è‡ªåŠ¨å¤‡ä»½
```bash
# æ·»åŠ åˆ°crontab
0 2 * * * /opt/scripts/backup.sh
```

### 2. ç¾éš¾æ¢å¤

#### 2.1 æ¢å¤æµç¨‹
1. é‡æ–°éƒ¨ç½²åŸºç¡€ç¯å¢ƒ
2. æ¢å¤åº”ç”¨ä»£ç å’Œæ¨¡å‹
3. é‡å¯æœåŠ¡
4. éªŒè¯åŠŸèƒ½

#### 2.2 æ¢å¤è„šæœ¬
```bash
#!/bin/bash
# æ¢å¤è„šæœ¬
BACKUP_FILE=$1

if [ -z "$BACKUP_FILE" ]; then
    echo "Usage: $0 <backup_file>"
    exit 1
fi

# åœæ­¢æœåŠ¡
systemctl stop chestxray-ai

# æ¢å¤æ–‡ä»¶
tar -xzf $BACKUP_FILE -C /opt/chestxray-ai/

# è®¾ç½®æƒé™
chown -R www-data:www-data /opt/chestxray-ai

# å¯åŠ¨æœåŠ¡
systemctl start chestxray-ai

echo "Recovery completed"
```

---

## â“ FAQ

### Q1: å¦‚ä½•æ›´æ–°æ¨¡å‹ï¼Ÿ
**A**: 
1. å¤‡ä»½ç°æœ‰æ¨¡å‹
2. è®­ç»ƒæ–°æ¨¡å‹: `python main.py train`
3. é‡å¯æœåŠ¡: `systemctl restart chestxray-ai`

### Q2: å¦‚ä½•å¢åŠ å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Ÿ
**A**:
1. å¢åŠ Gunicorn workers
2. é…ç½®è´Ÿè½½å‡è¡¡å™¨
3. ä½¿ç”¨Redisç¼“å­˜
4. è€ƒè™‘å¾®æœåŠ¡æ¶æ„

### Q3: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ä¸Šä¼ ï¼Ÿ
**A**:
1. è°ƒæ•´Nginx `client_max_body_size`
2. å¢åŠ Flask `MAX_CONTENT_LENGTH`
3. é…ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´

### Q4: Ollamaæ¨¡å‹å ç”¨ç©ºé—´å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ
**A**:
1. é€‰æ‹©è¾ƒå°çš„æ¨¡å‹å¦‚ `llama2:7b`
2. å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„æ¨¡å‹
3. é…ç½®æ¨¡å‹å­˜å‚¨ä½ç½®

### Q5: å¦‚ä½•ç›‘æ§ç³»ç»Ÿæ€§èƒ½ï¼Ÿ
**A**:
1. ä½¿ç”¨Prometheus + Grafana
2. é…ç½®æ—¥å¿—ç›‘æ§
3. è®¾ç½®å‘Šè­¦è§„åˆ™
4. å®šæœŸæ€§èƒ½æµ‹è¯•

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è”ç³»æ–¹å¼
- **æŠ€æœ¯æ–‡æ¡£**: æŸ¥çœ‹é¡¹ç›®README.md
- **é—®é¢˜æŠ¥å‘Š**: é€šè¿‡GitHub Issues
- **é‚®ä»¶æ”¯æŒ**: support@example.com

### ç¤¾åŒºèµ„æº
- **å®˜æ–¹æ–‡æ¡£**: https://pytorch.org/docs/
- **Ollamaæ–‡æ¡£**: https://ollama.ai/docs/
- **Flaskæ–‡æ¡£**: https://flask.palletsprojects.com/

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª MIT è®¸å¯è¯ã€‚è¯¦è§ LICENSE æ–‡ä»¶ã€‚

---

**âš ï¸ å…è´£å£°æ˜**: æœ¬ç³»ç»Ÿä»…ä¾›ç ”ç©¶å’Œæ•™è‚²ç”¨é€”ã€‚åœ¨åŒ»ç–—ç¯å¢ƒä¸­ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿ç¬¦åˆç›¸å…³æ³•è§„è¦æ±‚ï¼Œå¹¶ç»è¿‡ä¸“ä¸šåŒ»ç”ŸéªŒè¯ã€‚

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0 | æœ€åæ›´æ–°: 2025å¹´1æœˆ* 